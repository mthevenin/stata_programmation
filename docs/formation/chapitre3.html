<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.179">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Le langage Stata</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../formation/chapitre4.html" rel="next">
<link href="../formation/chapitre2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_fr/" rel="" target="">
 <span class="menu-text">Stata Ined</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_graphiques/" rel="" target="">
 <span class="menu-text">Graphiques</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_programmation/" rel="" target="">
 <span class="menu-text">Programmation</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marc.thevenin@ined.fr" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">A propos</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Le langage Stata</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Formation introductive</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre0.html" class="sidebar-item-text sidebar-link">Présentation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre1.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre2.html" class="sidebar-item-text sidebar-link">Environnement</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre3.html" class="sidebar-item-text sidebar-link active">Le langage Stata</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre4.html" class="sidebar-item-text sidebar-link">Les bases de données</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre5.html" class="sidebar-item-text sidebar-link">Les variables</a>
  </div>
</li>
          <li class="sidebar-item">
  formation/chapitre6.qmd
  </li>
          <li class="sidebar-item">
  formation/chapitre7.qmd
  </li>
          <li class="sidebar-item">
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Fichier profile</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../profile/profile1.html" class="sidebar-item-text sidebar-link">Principe</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../profile/profile2.html" class="sidebar-item-text sidebar-link">Exemple profile.do</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Need for speed</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../speedup/intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../speedup/gtools.html" class="sidebar-item-text sidebar-link">Gtools</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Super Macro World</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../macro/intro.html" class="sidebar-item-text sidebar-link">Présentation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">C’est dans l’R</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../R.html" class="sidebar-item-text sidebar-link">Stata et R</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Edition des outputs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tableaux/intro.html" class="sidebar-item-text sidebar-link">Intro - Collect</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#la-syntaxe-générique" id="toc-la-syntaxe-générique" class="nav-link active" data-scroll-target="#la-syntaxe-générique"><span class="toc-section-number">1</span>  <strong>La syntaxe générique</strong></a></li>
  <li><a href="#autres-langages-pris-en-charge" id="toc-autres-langages-pris-en-charge" class="nav-link" data-scroll-target="#autres-langages-pris-en-charge"><span class="toc-section-number">2</span>  <strong>Autres langages pris en charge</strong></a></li>
  <li><a href="#les-opérateurs" id="toc-les-opérateurs" class="nav-link" data-scroll-target="#les-opérateurs"><span class="toc-section-number">3</span>  <strong>Les opérateurs</strong></a></li>
  <li><a href="#les-valeurs-manquantes" id="toc-les-valeurs-manquantes" class="nav-link" data-scroll-target="#les-valeurs-manquantes"><span class="toc-section-number">4</span>  <strong>Les valeurs manquantes</strong></a></li>
  <li><a href="#casse-et-troncature" id="toc-casse-et-troncature" class="nav-link" data-scroll-target="#casse-et-troncature"><span class="toc-section-number">5</span>  <strong>Casse et troncature</strong></a>
  <ul class="collapse">
  <li><a href="#sensibilité-à-la-casse" id="toc-sensibilité-à-la-casse" class="nav-link" data-scroll-target="#sensibilité-à-la-casse"><span class="toc-section-number">5.1</span>  Sensibilité à la casse</a></li>
  <li><a href="#troncature-des-instructions-et-des-options" id="toc-troncature-des-instructions-et-des-options" class="nav-link" data-scroll-target="#troncature-des-instructions-et-des-options"><span class="toc-section-number">5.2</span>  Troncature des instructions et des options</a></li>
  </ul></li>
  <li><a href="#suppression-de-loutput-et-affichage-dune-expression" id="toc-suppression-de-loutput-et-affichage-dune-expression" class="nav-link" data-scroll-target="#suppression-de-loutput-et-affichage-dune-expression"><span class="toc-section-number">6</span>  <strong>Suppression de l’output, et affichage d’une expression</strong></a></li>
  <li><a href="#sélection-groupées-de-variables" id="toc-sélection-groupées-de-variables" class="nav-link" data-scroll-target="#sélection-groupées-de-variables"><span class="toc-section-number">7</span>  <strong>Sélection groupées de variables</strong></a></li>
  <li><a href="#macros-et-répétition" id="toc-macros-et-répétition" class="nav-link" data-scroll-target="#macros-et-répétition"><span class="toc-section-number">8</span>  <strong>Macros et répétition</strong></a>
  <ul class="collapse">
  <li><a href="#introduction-au-macros" id="toc-introduction-au-macros" class="nav-link" data-scroll-target="#introduction-au-macros"><span class="toc-section-number">8.1</span>  Introduction au macros</a></li>
  <li><a href="#objets-sauvegardés-lors-der-lexécution-dune-commande" id="toc-objets-sauvegardés-lors-der-lexécution-dune-commande" class="nav-link" data-scroll-target="#objets-sauvegardés-lors-der-lexécution-dune-commande"><span class="toc-section-number">8.2</span>  Objets sauvegardés lors der l’exécution d’une commande</a></li>
  <li><a href="#répétition-avec-des-boucles" id="toc-répétition-avec-des-boucles" class="nav-link" data-scroll-target="#répétition-avec-des-boucles"><span class="toc-section-number">8.3</span>  Répétition avec des boucles</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Le langage Stata</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<table class="table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>SECTION</th>
<th>COMMANDES ET EXPRESSIONS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Opérateurs</strong></td>
<td><code>=</code> <code>==</code> <code>&lt;</code> <code>&lt;=</code> <code>&gt;</code> <code>&gt;=</code> <code>!=</code> <code>&amp;</code> <code>|</code> <code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>^</code></td>
</tr>
<tr class="even">
<td><strong>Valeurs manquantes</strong></td>
<td><code>.</code> <strong><code>mdesc</code></strong> <strong><code>mvpatterns</code></strong> <strong><code>misschk</code></strong></td>
</tr>
<tr class="odd">
<td><strong>Suppression de l’output, et affichage d’une expression</strong></td>
<td><code>quietly</code> <code>display</code></td>
</tr>
<tr class="even">
<td><strong>Sélection groupées</strong></td>
<td><em><code>drop</code></em> <em><code>keep</code></em> <code>*</code> <code>-</code></td>
</tr>
<tr class="odd">
<td><strong>Macros et répétition</strong></td>
<td><code>local</code> <code>global</code> <code>foreach</code> <code>forvalue</code> <code>return list</code> <code>i</code> <em><code>regress</code></em></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>En gras, commandes externes</strong></li>
<li><em>En italique, commandes associées à un chapitre ultérieur</em></li>
</ul>
<section id="la-syntaxe-générique" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> <strong>La syntaxe générique</strong></h1>
<p><strong>Remarque sur les crochets</strong></p>
<div class="callout callout-style-default callout-note callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
[…] expression entre crochets
</div>
</div>
<div class="callout-body-container callout-body">
<p>A ma connaissance, à l’exception des pondérations il n’y a pas d’utilisation de crochets dans la syntaxe des commandes usines. Dans les fichiers d’aide et pour cette formation, ils indiquent les expressions optionnelles d’une ligne d’instructions.</p>
</div>
</div>
<p>Forme concise de la syntaxe STATA pour une instruction portant sur des variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>nom_command <span class="kw">varlist</span> [, options ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Exemple</em></strong> : <strong><code>tabulate var1 var2, nofreq row</code></strong></p>
<p>Ce qui ce traduit par: produire un tableau croisé entre <em>var1</em> (en ligne) et la <em>var2</em> (en colonne) en affichant la répartition en % de <em>var2</em> pour chaque valeur de <em>var1</em> et pour l’ensemble des donnnées renseignées .</p>
<div class="cell" data-collectcode="true">
<div class="cell-output cell-output-stdout">
<pre><code>(1978 automobile data)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tabulate</span> rep78 foreign, nofreq <span class="ot">row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>    Repair |
    record |      Car origin
      1978 |  Domestic    Foreign |     Total
-----------+----------------------+----------
         1 |    100.00       0.00 |    100.00 
         2 |    100.00       0.00 |    100.00 
         3 |     90.00      10.00 |    100.00 
         4 |     50.00      50.00 |    100.00 
         5 |     18.18      81.82 |    100.00 
-----------+----------------------+----------
     Total |     69.57      30.43 |    100.00 </code></pre>
</div>
</div>
<ul>
<li>Forme générique de la syntaxe STATA</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>[<span class="kw">prefix</span>:] command <span class="kw">varlist</span> [ [type_weight=<span class="kw">var</span>] <span class="kw">if</span>/<span class="kw">in</span>, options]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Expression conditionnelle (sélection): <code>if</code> (sélection de valeurs) ou <code>in</code> (sélection d’observations)</p>
<p>Exemple : <strong><code>bysort var2: summarize var1 if var4!=1, detail</code></strong><br>
Ce qui ce traduit par: pour chaque valeur de <em>var2</em>, des statistiques descriptives détaillées pour la variable <em>var1</em> si la valeur de <em>var3</em> est différente de 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> foreign: <span class="kw">summarize</span> price <span class="kw">if</span> rep78!=1, <span class="kw">detail</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>-&gt; foreign = Domestic

                            Price
-------------------------------------------------------------
      Percentiles      Smallest
 1%         3291           3291
 5%         3667           3299
10%         3892           3667       Obs                  50
25%         4181           3799       Sum of wgt.          50

50%       4782.5                      Mean            6132.74
                        Largest       Std. dev.      3143.481
75%         6303          13466
90%        11441          13594       Variance        9881473
95%        13594          14500       Skewness       1.717717
99%        15906          15906       Kurtosis       4.857758

-------------------------------------------------------------------------------
-&gt; foreign = Foreign

                            Price
-------------------------------------------------------------
      Percentiles      Smallest
 1%         3748           3748
 5%         3798           3798
10%         3895           3895       Obs                  22
25%         4499           3995       Sum of wgt.          22

50%         5759                      Mean           6384.682
                        Largest       Std. dev.      2621.915
75%         7140           9690
90%         9735           9735       Variance        6874439
95%        11995          11995       Skewness       1.215236
99%        12990          12990       Kurtosis       3.555178</code></pre>
</div>
</div>
<p>Si la commande implique une base de données, le nom de la base est généralement précédée de <strong>`using``</strong> (sauf pour les instructions officielle d’ouverture/sauvegarde d’une base):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>command <span class="kw">using</span> nom_base [,options]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="autres-langages-pris-en-charge" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> <strong>Autres langages pris en charge</strong></h1>
<p><em>interne</em></p>
<ul>
<li>Langage matriciel (MATA)</li>
<li>Editeur de texte (SMCL) pour rédiger les aides ou paramétrer la forme des outputs (c’est une une horreur)</li>
<li>Création de boites de dialogue (proche du Java)</li>
<li>La programmation de commande dispose d’un certain nombre d’éléments de langage dédié. Pour une réutilisation ultérieure automatisée, le programme est enregistré dans un fichier <em>.ado</em></li>
</ul>
<p><em>Externe</em></p>
<ul>
<li>Via une commande externe (<code>rsource</code>), on peut exécuté du R. R doit ête bien évidemment installé.</li>
</ul>
<div class="cell" data-collectcode="true">
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>rsource, terminator(END_OF_R) </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>library(readr)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>trans &lt;- read.csv(<span class="st">"https://raw.githubusercontent.com/mthevenin/analyse_duree/master/bases/transplantation.csv"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trans)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="kw">table</span>(trans<span class="ot">$died</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>END_OF_R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  id <span class="fu">year</span> age died stime surgery transplant wait mois compet</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>1 15   68  53    1     1       0          0    0    1      1</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>2 43   70  43    1     2       0          0    0    1      1</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>3 61   71  52    1     2       0          0    0    1      1</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>4 75   72  52    1     2       0          0    0    1      1</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>5  6   68  54    1     3       0          0    0    1      2</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>6 42   70  36    1     3       0          0    0    1      1</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="kw">table</span>(trans<span class="ot">$died</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a> 0  1 </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>28 75 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Depuis la version 16 on peut programmer intéractivement en Python avec Stata. Cette intégration permet à Python de reconnaitre les macros stata dans son code…c’est très utile. Python doit néanmoins être installé manuellement.</li>
</ul>
<p><em>Vérification de l’installation</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>python <span class="kw">query</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>    Python Settings
      set python_exec      C:/Users/thevenin_m/AppData/Local/Programs/Python/Py
&gt; thon310/python.exe
      set python_userpath  

    Python system information
      initialized          yes
      version              3.10.5
      architecture         64-bit
      library path         C:\Users\thevenin_m\AppData\Local\Programs\Python\Py
&gt; thon310\python310.dll</code></pre>
</div>
</div>
<p><em>Utilisation de python</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>python: </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>a = 4</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>b = 2</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>a*b</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>----------------------------------------------- python (type end to exit) -----
&gt;&gt;&gt; 
&gt;&gt;&gt; a = 4
&gt;&gt;&gt; b = 2
&gt;&gt;&gt; a*b
8
&gt;&gt;&gt;  
&gt;&gt;&gt; end
-------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>python:</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>import pandas <span class="kw">as</span> pd</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>trans = pd.read_csv(<span class="st">"https://raw.githubusercontent.com/mthevenin/analyse_duree/master/bases/transplantation.csv"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>trans.<span class="fu">head</span>(10)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>trans.info()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>----------------------------------------------- python (type end to exit) -----
&gt;&gt;&gt; import pandas as pd
&gt;&gt;&gt; trans = pd.read_csv("https://raw.githubusercontent.com/mthevenin/analyse_du
&gt; ree/master/bases/transplantation.csv")
&gt;&gt;&gt; 
&gt;&gt;&gt; trans.head(10)
   id  year  age  died  stime  surgery  transplant  wait  mois  compet
0  15    68   53     1      1        0           0     0     1       1
1  43    70   43     1      2        0           0     0     1       1
2  61    71   52     1      2        0           0     0     1       1
3  75    72   52     1      2        0           0     0     1       1
4   6    68   54     1      3        0           0     0     1       2
5  42    70   36     1      3        0           0     0     1       1
6  54    71   47     1      3        0           0     0     1       1
7  38    70   41     1      5        0           1     5     1       1
8  85    73   47     1      5        0           0     0     1       1
9   2    68   51     1      6        0           0     0     1       1
&gt;&gt;&gt; trans.info()
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 103 entries, 0 to 102
Data columns (total 10 columns):
 #   Column      Non-Null Count  Dtype
---  ------      --------------  -----
 0   id          103 non-null    int64
 1   year        103 non-null    int64
 2   age         103 non-null    int64
 3   died        103 non-null    int64
 4   stime       103 non-null    int64
 5   surgery     103 non-null    int64
 6   transplant  103 non-null    int64
 7   wait        103 non-null    int64
 8   mois        103 non-null    int64
 9   compet      103 non-null    int64
dtypes: int64(10)
memory usage: 8.2 KB
&gt;&gt;&gt; end
-------------------------------------------------------------------------------</code></pre>
</div>
</div>
<ul>
<li><p>Depuis la version 17 de Stata, on peut également programmer intéractivement en <em>Java</em>… mais là je n’y connais absolument rien.</p></li>
<li><p>Intégration de l’édition en <em>markdown</em> pour produire des rapports en html ou pdf. Egalement possibilité de générer des documents word ou excel avec des commandes dédiées. L’intégration de <em>latex</em> est également possible via une commande externe. Toutes ces possibilité me semble néanmoins nettement en deçà de ce qui est réalisable actuellement avec <strong>RStudio</strong> en particulier avec le nouvel outil <code>Quarto</code> associé à <code>Statamarkdown</code>…qui sont utilisés pour faire ce support.</p></li>
</ul>
</section>
<section id="les-opérateurs" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> <strong>Les opérateurs</strong></h1>
<table class="table">
<thead>
<tr class="header">
<th><strong>Opérateurs</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong><code>&amp;</code></strong> <strong>Et</strong></td>
</tr>
<tr class="even">
<td><strong><code>|</code></strong> [Alt+Gr6] <strong>Ou</strong></td>
</tr>
<tr class="odd">
<td><strong>Opérateurs d’affectation</strong></td>
</tr>
<tr class="even">
<td><strong><code>=</code></strong></td>
</tr>
<tr class="odd">
<td><strong>Opérateurs pour expressions conditionnelles</strong></td>
</tr>
<tr class="even">
<td><strong><code>==</code></strong></td>
</tr>
<tr class="odd">
<td><strong><code>!=</code></strong></td>
</tr>
<tr class="even">
<td><strong><code>&gt;</code></strong></td>
</tr>
<tr class="odd">
<td><strong><code>&gt;=</code></strong></td>
</tr>
<tr class="even">
<td><strong><code>&lt;</code></strong></td>
</tr>
<tr class="odd">
<td><strong><code>&lt;=</code></strong></td>
</tr>
<tr class="even">
<td><strong>Opérateurs arithmétique</strong></td>
</tr>
<tr class="odd">
<td><code>+</code> , <code>-</code> , <code>/</code> , ^ (puissance)</td>
</tr>
<tr class="even">
<td><strong>Opérateur chaîne de caractères</strong></td>
</tr>
<tr class="odd">
<td><code>+</code></td>
</tr>
</tbody>
</table>
<p>[1] <em><code>+</code></em> concatène des variables caractères qui n’ont pas de valeur manquante. Sinon utiliser <strong><code>concat</code></strong> associée à la commande <strong><code>egen</code></strong> (voir chapitre sur la création de variables).</p>
</section>
<section id="les-valeurs-manquantes" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> <strong>Les valeurs manquantes</strong></h1>
<div class="callout callout-style-default callout-important callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Statut des valeurs manquantes
</div>
</div>
<div class="callout-body-container callout-body">
<p>La valeur d’une observation manquante dépasse la plus grande valeur observée d’une variable. Ceci doit être pris en compte dans les expressions conditionnelles impliquant par exemple des regroupement de variables ordinales ou mésurées (âge, revenus…):<br>
Si une variable numérique <span class="math inline">\(X\)</span> a des observations manquantes, la condition <code>if X&gt;valeur</code> conservera ces informations.</p>
<p>Si <span class="math inline">\(X=(1, 2, 3, 4, 5, 6, .)\)</span>:</p>
<ul>
<li><code>...if x&gt;4</code> conserve <span class="math inline">\(x=(5,6,.)\)</span><br>
</li>
<li><code>...if x&gt;4 &amp; x&lt;.</code> ou <code>...if x&gt;4 &amp; x!=.</code> regroupe seulement <span class="math inline">\(x=(5,6)\)</span></li>
</ul>
</div>
</div>
<p><strong>Les valeurs manquantes utilisateurs</strong><br>
On peut rendre la valeur manquante informative en lui ajoutant une lettre: <strong>.a</strong> , <strong>.b</strong>, <strong>.c</strong> etc….</p>
<p>Exemple:</p>
<ul>
<li><em>.a</em> = Ne sait pas.</li>
<li><em>.b</em> =Refus.</li>
<li><em>.c</em> =Pas de réponse.</li>
</ul>
<p><strong>Repérage des valeurs manquantes</strong></p>
<p>Des commandes, comme <code>tabulate</code> avec l’option <code>mis</code> pour les variables catégorielles, permettent de repérer et d’afficher le nombre d’observations manquantes.</p>
<p>Il y a aussi plusieurs commandes qui permettent d’analyser ce type d’observations observations globalement.</p>
<ul>
<li>Commande externe <strong><code>mdesc</code></strong>: affiche pour chaque variable de la base ou une sélection de celle, le nombre et le % d’observations manquantes.
<ul>
<li>installation: <code>ssc install mdesc</code></li>
<li>syntaxe: <code>mdesc [varlist]</code></li>
</ul></li>
</ul>
<div class="cell" data-collectcode="true">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto.dta, <span class="kw">clear</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>mdesc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>(1978 automobile data)

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
           make |           0             74           0.00
          price |           0             74           0.00
            mpg |           0             74           0.00
          rep78 |           5             74           6.76
       headroom |           0             74           0.00
          trunk |           0             74           0.00
         weight |           0             74           0.00
         length |           0             74           0.00
           turn |           0             74           0.00
   displacement |           0             74           0.00
     gear_ratio |           0             74           0.00
        foreign |           0             74           0.00
----------------+-----------------------------------------------</code></pre>
</div>
</div>
<ul>
<li>commandes externes <code>mvpatterns</code> et <code>misschk</code> pour analyser les différents patterns de valeurs manquantes (une même observation peut avoir des valeurs manquantes sur plusieurs variables). <code>misschk</code> ne scanne que les variables de type numérique, et permet de générer deux variables pour indiquer le nombre et le pattern de valeurs manquantes pour chaque observation.
<ul>
<li>installation: <code>ssc install mvpatterns</code> et <code>ssc install misschk</code></li>
<li>syntaxe: <code>mvpatterns [varlist]</code> et <code>misschk [varlist], gen(nom)</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mvpatterns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>variables with no mv's: make price mpg headroom trunk weight length turn
                    displacement gear_ratio foreign

Variable     | type     obs   mv   variable label
-------------+---------------------------------------
rep78        | int       69    5   Repair record 1978
-----------------------------------------------------

Patterns of missing values

  +------------------------+
  | _pattern   _mv   _freq |
  |------------------------|
  |        +     0      69 |
  |        .     1       5 |
  +------------------------+</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>misschk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>Variables examined for missing values

   #  Variable        # Missing   % Missing
--------------------------------------------
   1  price                 0         0.0
   2  mpg                   0         0.0
   3  rep78                 5         6.8
   4  headroom              0         0.0
   5  trunk                 0         0.0
   6  weight                0         0.0
   7  length                0         0.0
   8  turn                  0         0.0
   9  displacement          0         0.0
   10 gear_ratio            0         0.0
   11 foreign               0         0.0

Warning: this output does not differentiate among extended missing.
To generate patterns for extended missing, use extmiss option.

   Missing for |
         which |
    variables? |      Freq.     Percent        Cum.
---------------+-----------------------------------
 __3__ _____ _ |          5        6.76        6.76
 _____ _____ _ |         69       93.24      100.00
---------------+-----------------------------------
         Total |         74      100.00

Missing for |
   how many |
 variables? |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |         69       93.24       93.24
          1 |          5        6.76      100.00
------------+-----------------------------------
      Total |         74      100.00</code></pre>
</div>
</div>
</section>
<section id="casse-et-troncature" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> <strong>Casse et troncature</strong></h1>
<section id="sensibilité-à-la-casse" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sensibilité-à-la-casse"><span class="header-section-number">5.1</span> Sensibilité à la casse</h2>
<p>Comme R ou Python, Stata est intégralement sensible à la casse pour les instructions, seulement en minuscules. Par exemple <code>TABULATE X</code> renverra un message d’erreur.</p>
</section>
<section id="troncature-des-instructions-et-des-options" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="troncature-des-instructions-et-des-options"><span class="header-section-number">5.2</span> Troncature des instructions et des options</h2>
<p>Dans le fichier d’aire d’une commande usine ou externe, le niveau de troncature est indiqué par un soulignement dans l’instruction: par exemple <strong><code>tabulate</code></strong> est souligné au niveau de <strong>ta</strong> : <strong>tabulate</strong> = <strong>tabulat</strong> = <strong>tabula</strong> = <strong>tabul</strong> = <strong>tabu</strong> = <strong>tab</strong> = <strong>ta</strong>. On utilise généralement <code>tabulate</code> ou <code>tab</code>.</p>
<p>A manier avec une certaine précaution car le programme peut devenir rapidement incompréhensible, surtout s’il est partagé entre personnes dont la pratique diffère à ce niveau:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tabulate</span> var1 var2, nofreq <span class="ot">row</span> miss  </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>* <span class="kw">est</span> équivalent à: </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ta var1 var2, nof <span class="fu">r</span> <span class="fu">m</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="suppression-de-loutput-et-affichage-dune-expression" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> <strong>Suppression de l’output, et affichage d’une expression</strong></h1>
<p>On peut rendre le résultat d’une commande invisible dans la fenêtre output avec <code>quietly</code> (<code>qui</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> rep78</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">tab</span> rep78</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     Repair |
record 1978 |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          2        2.90        2.90
          2 |          8       11.59       14.49
          3 |         30       43.48       57.97
          4 |         18       26.09       84.06
          5 |         11       15.94      100.00
------------+-----------------------------------
      Total |         69      100.00</code></pre>
</div>
</div>
<p>Remarque: ne fonctionne pas avec les graphiques où l’on doit utiliser l’option <code>nodraw</code></p>
<p><strong>display (di)</strong></p>
<p>Ce n’est pas une commande à proprement parler, mais l’instruction <code>display</code> (<code>di</code>) permet d’afficher dans l’output, entres autres, des opérations arithmétiques (c’est donc une calculatrice).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> <span class="fu">exp</span>(1)/(1+<span class="fu">exp</span>(1))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> <span class="st">"SALUT!!!!"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>.73105858

SALUT!!!!</code></pre>
</div>
</div>
<p>Elle est également utilisé pour vérifier le contenu d’une macro variable, de préférence lorsque cette macro implique des valeurs.</p>
</section>
<section id="sélection-groupées-de-variables" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> <strong>Sélection groupées de variables</strong></h1>
<p>Commandes associées pour filtrer: <strong><code>keep</code></strong>, <strong><code>drop</code></strong> [pour sélectionner des obseravations: <code>keep if</code>, <code>drop if</code>]</p>
<p>On peut sélectionner un ensemble de variables qui ont une racine commune, par exemple <strong>c</strong>, en écrivant : <code>*c*</code>.<br>
Exemple:<br>
<em>television</em>, <em>telephone</em>, <em>table</em> ont comme racine <strong>t</strong>. Pour supprimer ces variables, on peut exécuter <code>drop t*</code> au lieu de <code>drop television telephone table</code>.<br>
Si on souhaite supprimer <em>television</em> et <em>telephone</em> seulement : <code>drop tele*</code>.</p>
<p>Si on veut sélectionner des variables occurencées ou comme dans la base <em>auto</em> les 5 variables qui se suivent [<em>headroom</em>, <em>trunk</em>, <em>weight</em>, <em>length</em>, <em>turn</em>]: <code>keep headroom-turn</code> . Pour des variables occurencées de x1 à x5: <code>keep x1-x5</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> t*</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       trunk |         74    13.75676    4.277404          5         23
        turn |         74    39.64865    4.399354         31         51</code></pre>
</div>
</div>
</section>
<section id="macros-et-répétition" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> <strong>Macros et répétition</strong></h1>
<section id="introduction-au-macros" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introduction-au-macros"><span class="header-section-number">8.1</span> Introduction au macros</h2>
<p>Juste une introduction…Vu la simplicité du langage Stata, il est conseiller de se mettre rapidement à la manipulation des expressions dites <code>macro</code>.</p>
<ul>
<li>Une macro, dans sa version la plus simple, est une expression qui est utilisée une ou plusieurs fois dans un programme. Elle sont de type temporaire (<code>local</code>) ou enregistré en dur (<code>global</code>).</li>
<li>Les commandes, en particulier sur les opérations statistiques, enregistre un certains nombre d’objet de type macro qui peuvent être utilisés ultérieurement. On peut récupérer leur liste à la fin du fichier d’aide, et les visualiser les valeurs enregistrées après avoir exécuté une commande avec <code>return list</code>, <code>ereturn list</code>…<br>
</li>
<li>Un autre type d’objet, appelé <strong><code>scalar</code></strong> ressemble à une macro mais n’en est pas. Il s’agit de pseudo variables. Ils ne seront pas traités.</li>
<li>Le contenu d’une macro peut être affiché avec <code>display</code> ou <code>macro list</code> (<code>mac list</code>)
<ul>
<li>privilégier <code>display</code> pour afficher le contenu d’une macro de type valeur</li>
<li>privilégier <code>mac list</code> pour afficher le contenu d’une macro de type chaîne de caractère lorsque des doubles quotes (“) doivent rester apparentes. La gestion des” dans les macros peut s’avérer particulièrement retord.
<ul>
<li>macro <em>local</em>: mac list _macroname<br>
</li>
<li>macro <em>global</em>: mac list macroname</li>
</ul></li>
</ul></li>
</ul>
<p><strong>Macro temporaire</strong></p>
<p>L’instruction <code>local</code> permet de définir des macros variables temporaire (disparaissent après l’exécution du programme):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> nom_macro expression</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>* ou</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> nom_macro = expression numérique</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>* ou</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> nom_macro :  fonction <span class="kw">macro</span> <span class="co">// hors contenu de la formation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> a = 2</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> <span class="ot">`a'</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> 5^(<span class="ot">`a'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>2

25</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="kw">var</span>   mpg foreign</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> <span class="st">"`var`"</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _var</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> <span class="ot">`var'</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> price `var`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>`var`

_var:           mpg foreign

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         mpg |         74     21.2973    5.785503         12         41
     foreign |         74    .2972973    .4601885          0          1

` invalid name
r(198);

end of do-file
r(198);</code></pre>
</div>
</div>
<p>On en voit tout de suite l’utilité: si je veux changer la liste de variables pour les instructions <code>sum</code> (troncature de <code>summarize</code>) et pour <code>regress</code>, je le fais une fois (dans la définition de la macro) au lieu de deux.</p>
<p>Avec Stata peut définir également des macros dites <em>global</em> qui sont sauvegardées et s’appliqueront à tous les programmes (on peut les supprimer). Leur utilisation est moins courante: <code>global nom_macro expression</code>, le nom de la macro dans l’expression s’écrira <code>$nom_macro</code>.<br>
Il est conseillé de les supprimer en fin de programme avec <code>macro drop</code> + noms des macros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> <span class="kw">var</span> mpg <span class="kw">weight</span> <span class="fu">length</span> turn</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> <span class="st">"$var"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> <span class="kw">var</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> <span class="ot">$var</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> price <span class="ot">$var</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="kw">macro</span> <span class="kw">drop</span> <span class="kw">var</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>mpg weight length turn

var:            mpg weight length turn

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         mpg |         74     21.2973    5.785503         12         41
      weight |         74    3019.459    777.1936       1760       4840
      length |         74    187.9324    22.26634        142        233
        turn |         74    39.64865    4.399354         31         51

      Source |       SS           df       MS      Number of obs   =        74
-------------+----------------------------------   F(4, 69)        =     12.13
       Model |   262166817         4  65541704.3   Prob &gt; F        =    0.0000
    Residual |   372898579        69  5404327.23   R-squared       =    0.4128
-------------+----------------------------------   Adj R-squared   =    0.3788
       Total |   635065396        73  8699525.97   Root MSE        =    2324.7

------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |    -94.651     80.879    -1.17   0.246     -256.000      66.697
      weight |      5.030      1.154     4.36   0.000        2.728       7.332
      length |    -73.147     40.212    -1.82   0.073     -153.368       7.074
        turn |   -323.861    126.882    -2.55   0.013     -576.983     -70.738
       _cons |  19581.418   6005.223     3.26   0.002     7601.327   31561.509
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>La liste des macro enregistrées en dur est donnée par l’instruction: <code>macro dir</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">dir</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>GRSTYLE_SN0:    s2color
GRSTYLE_SN:     _GRSTYLE_
GRSTYLE_FN:     D:\D\ado\personal/scheme-_GRSTYLE_.scheme
Rterm_options:  --vanilla
Rterm_path:     C:\Program Files\R\R-4.1.2\bin\R.exe
tmp:            D:\D\stata_temp\
user:           C:\Users\thevenin_m\
F1:             help advice;
F2:             describe;
F7:             save
F8:             use
S_ADO:          BASE;SITE;.;PERSONAL;PLUS;OLDPLACE
S_StataSE:      SE
S_OS:           Windows
S_OSDTL:        64-bit
S_MACH:         PC (64-bit x86-64)
S_level:        95
S_MODE:         batch
S_FN:           C:\PROGRA~1\Stata17\ado\base/a/auto.dta
S_FNDATE:       13 Apr 2020 17:45</code></pre>
</div>
</div>
</section>
<section id="objets-sauvegardés-lors-der-lexécution-dune-commande" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="objets-sauvegardés-lors-der-lexécution-dune-commande"><span class="header-section-number">8.2</span> Objets sauvegardés lors der l’exécution d’une commande</h2>
<ul>
<li>Ces objets de type macro ne sont conservés en mémoire qu’entre 2 commandes exécutés</li>
<li>On peut donc les manipuler qu’à ce moment là, en particulier les enregistrer sous forme de macro standard pour les utiliser ultérieurement.</li>
</ul>
<div class="cell" data-collectcode="true">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">sum</span> price</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> <span class="ot">list</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> mprice = <span class="fu">r</span>(<span class="kw">mean</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span> <span class="ot">`mprice'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>scalars:
                  r(N) =  74
              r(sum_w) =  74
               r(mean) =  6165.256756756757
                r(Var) =  8699525.974268788
                 r(sd) =  2949.495884768919
                r(min) =  3291
                r(max) =  15906
                r(sum) =  456229


6165.2568</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Une application typique est la normalisation d’une pondération brute (somme des poids = nombre d’observation dans l’échantillon).<br>
Si <em>wb</em> est la pondération brute (somme des poids = population cible), et <em>wn</em> les poids que l’on souhaite normaliser:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">sum</span> wb</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> wn = wb/<span class="ot">`r(mean)'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tout changement de la variable <em>wb</em> modifiera automatiquement la normalisation.</p>
<p>Pour la commande **<code>gen</code> (ou <code>generate</code>) se reporter au chapitre 5.</p>
</div>
</div>
</section>
<section id="répétition-avec-des-boucles" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="répétition-avec-des-boucles"><span class="header-section-number">8.3</span> Répétition avec des boucles</h2>
<ul>
<li><strong>`forvalues</strong>: valeurs occurencées, compteur</li>
</ul>
<p><code>for num 1/n: commande</code> est de plus en plus abandonnée (aide Stata supprimée). On lui préfère maintenant l’instruction <code>forvalues</code> pour effectuer des boucles sur des occurences numériques.</p>
<p>Si l’on souhaite par exemple changer le nom des variables x1 à x9 en var1, var2,…., var9:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> i=1/9 {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">rename</span> x<span class="ot">`i'</span> var<span class="ot">`i'</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>foreach</code></strong>: termes d’une expression enregistrée sous la forme d’une macro</li>
</ul>
<p>Par l’exemple, et juste une petite introduction. On veut faire une régression linéaire entre la variable <em>price</em> et la variable <em>foreign</em> en ajoutant une seule autre variable dans cette liste: <em>mpg</em>, <em>headroom</em>, <em>trunk</em>.</p>
<p>Au lieu d’exécuter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> price foreign mpg      </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> price foreign headroom </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> price foreign trunk    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On génère une macro variable temporaire qui liste ces 3 variables , et on exécute une boucle avec l’instruction <code>foreach</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="kw">var</span> mpg headroom trunk</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> x <span class="kw">of</span> <span class="kw">local</span> <span class="kw">var</span> {</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> price foreign <span class="ot">`x'</span>, <span class="kw">noheader</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     foreign |   1767.292    700.158     2.52   0.014      371.217    3163.368
         mpg |   -294.196     55.692    -5.28   0.000     -405.242    -183.149
       _cons |  11905.415   1158.634    10.28   0.000     9595.164   14215.667
------------------------------------------------------------------------------
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     foreign |    577.812    787.566     0.73   0.466     -992.549    2148.174
    headroom |    491.575    428.405     1.15   0.255     -362.641    1345.791
       _cons |   4522.071   1412.097     3.20   0.002     1706.430    7337.711
------------------------------------------------------------------------------
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     foreign |   1190.155    760.805     1.56   0.122     -326.847    2707.157
       trunk |    262.772     81.852     3.21   0.002       99.564     425.980
       _cons |   2196.541   1267.857     1.73   0.088     -331.494    4724.576
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>….et on peut aller plus loin… Juste pour information car cela se complique (et pas qu’un peu), avec une technique de macro empilée, on ajoute les les variables une à une au modèle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> j mpg <span class="kw">weight</span> <span class="fu">length</span> turn headroom trunk</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> j2 <span class="kw">of</span> <span class="kw">local</span> j {</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> x <span class="ot">`x'</span> <span class="ot">`j2'</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="kw">di</span>  <span class="st">"covariables introduites = `x'"</span>  <span class="co">// pour afficher ce qui est lu dans la macro</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> price <span class="ot">`x'</span> , <span class="kw">noheader</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>  4.   
covariables introduites = mpg
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |   -238.894     53.077    -4.50   0.000     -344.701    -133.088
       _cons |  11253.061   1170.813     9.61   0.000     8919.088   13587.033
------------------------------------------------------------------------------
covariables introduites = mpg weight
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |    -49.512     86.156    -0.57   0.567     -221.302     122.278
      weight |      1.747      0.641     2.72   0.008        0.468       3.025
       _cons |   1946.069   3597.050     0.54   0.590    -5226.245    9118.382
------------------------------------------------------------------------------
covariables introduites = mpg weight length
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |    -86.789     83.943    -1.03   0.305     -254.209      80.630
      weight |      4.365      1.167     3.74   0.000        2.036       6.693
      length |   -104.868     39.722    -2.64   0.010     -184.090     -25.646
       _cons |  14542.434   5890.632     2.47   0.016     2793.940   26290.929
------------------------------------------------------------------------------
covariables introduites = mpg weight length turn
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |    -94.651     80.879    -1.17   0.246     -256.000      66.697
      weight |      5.030      1.154     4.36   0.000        2.728       7.332
      length |    -73.147     40.212    -1.82   0.073     -153.368       7.074
        turn |   -323.861    126.882    -2.55   0.013     -576.983     -70.738
       _cons |  19581.418   6005.223     3.26   0.002     7601.327   31561.509
------------------------------------------------------------------------------
covariables introduites = mpg weight length turn headroom
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |    -96.145     80.259    -1.20   0.235     -256.300      64.010
      weight |      5.015      1.145     4.38   0.000        2.730       7.300
      length |    -60.922     40.791    -1.49   0.140     -142.319      20.476
        turn |   -332.592    126.045    -2.64   0.010     -584.111     -81.073
    headroom |   -538.252    373.149    -1.44   0.154    -1282.859     206.356
       _cons |  19317.280   5961.554     3.24   0.002     7421.185   31213.375
------------------------------------------------------------------------------
covariables introduites = mpg weight length turn headroom trunk
------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         mpg |    -94.063     80.371    -1.17   0.246     -254.484      66.357
      weight |      5.079      1.148     4.42   0.000        2.788       7.371
      length |    -73.487     43.011    -1.71   0.092     -159.338      12.364
        turn |   -327.070    126.311    -2.59   0.012     -579.188     -74.952
    headroom |   -731.292    427.369    -1.71   0.092    -1584.324     121.740
       trunk |     98.275    105.721     0.93   0.356     -112.745     309.295
       _cons |  20447.251   6090.068     3.36   0.001     8291.424   32603.078
------------------------------------------------------------------------------</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../formation/chapitre2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Environnement</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../formation/chapitre4.html" class="pagination-link">
        <span class="nav-page-text">Les bases de données</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Marc Thévenin - Ined-Sms - Août 2022</div>
  </div>
</footer>



</body></html>