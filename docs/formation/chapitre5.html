<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.330">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Les variables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../formation/chapitre6.html" rel="next">
<link href="../formation/chapitre4.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_fr/" rel="" target="">
 <span class="menu-text">Stata Ined</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_graphiques/" rel="" target="">
 <span class="menu-text">Graphiques</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_programmation/" rel="" target="">
 <span class="menu-text">Programmation</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marc.thevenin@ined.fr" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">A propos</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../formation/chapitre0.html">Formation introductive</a></li><li class="breadcrumb-item"><a href="../formation/chapitre5.html">Les variables</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Formation introductive</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Environnement</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Le langage Stata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Les bases de données</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Les variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/chapitre6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Opérations sur les bases</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">formation/chapitre7.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">  </span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Fichier profile</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../profile/profile1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principe</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../profile/profile2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exemple profile.do</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Need for speed</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../speedup/gtools/gtools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gtools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../speedup/frame/frame.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frame</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Super Macro World</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../macro/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">C’est dans l’R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stata et R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Edition des outputs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tableaux/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro - Collect</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#types-et-format" id="toc-types-et-format" class="nav-link active" data-scroll-target="#types-et-format"><span class="header-section-number">1</span> <strong>Types et format</strong></a>
  <ul class="collapse">
  <li><a href="#types" id="toc-types" class="nav-link" data-scroll-target="#types"><span class="header-section-number">1.1</span> Types</a></li>
  <li><a href="#format" id="toc-format" class="nav-link" data-scroll-target="#format"><span class="header-section-number">1.2</span> Format</a></li>
  <li><a href="#modification-du-type" id="toc-modification-du-type" class="nav-link" data-scroll-target="#modification-du-type"><span class="header-section-number">1.3</span> Modification du type</a></li>
  </ul></li>
  <li><a href="#création-dune-variable" id="toc-création-dune-variable" class="nav-link" data-scroll-target="#création-dune-variable"><span class="header-section-number">2</span> <strong>Création d’une variable</strong></a>
  <ul class="collapse">
  <li><a href="#generate---replace" id="toc-generate---replace" class="nav-link" data-scroll-target="#generate---replace"><span class="header-section-number">2.1</span> generate - replace</a></li>
  <li><a href="#egen" id="toc-egen" class="nav-link" data-scroll-target="#egen"><span class="header-section-number">2.2</span> egen</a></li>
  </ul></li>
  <li><a href="#les-variables-internes-de-comptage" id="toc-les-variables-internes-de-comptage" class="nav-link" data-scroll-target="#les-variables-internes-de-comptage"><span class="header-section-number">3</span> <strong>Les variables internes de comptage</strong></a></li>
  <li><a href="#sélection-de-plusieurs-modalités-recodage" id="toc-sélection-de-plusieurs-modalités-recodage" class="nav-link" data-scroll-target="#sélection-de-plusieurs-modalités-recodage"><span class="header-section-number">4</span> <strong>Sélection de plusieurs modalités, recodage</strong></a></li>
  <li><a href="#les-labels" id="toc-les-labels" class="nav-link" data-scroll-target="#les-labels"><span class="header-section-number">5</span> <strong>Les labels</strong></a>
  <ul class="collapse">
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo"><span class="header-section-number">5.1</span> TODO</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="chapitre5.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Les variables</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="https://github.com/mthevenin/formation_stata/blob/master/programmes/chapitre5.md"><strong>Programme du chapitre</strong></a></p>
<p><em>Commandes et expressions introduites</em></p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>SECTION</th>
<th>COMMANDES</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Types-formats</strong></td>
<td><code>recast</code> - <code>format</code> - <code>tostring</code> - <code>destring</code> - <code>decode</code> - <code>encode</code> - <strong><code>sencode</code></strong></td>
</tr>
<tr class="even">
<td><strong>Création variable</strong></td>
<td><code>generate</code> - <code>replace</code> - <code>egen</code> [+ exemples de fonctions associées)</td>
</tr>
<tr class="odd">
<td><strong>Variables de comptage</strong></td>
<td><code>_n</code> et <code>_N</code></td>
</tr>
<tr class="even">
<td><strong>Sélection et recodage</strong></td>
<td><code>inlist</code> - <code>inrange</code> - <code>recode</code></td>
</tr>
<tr class="odd">
<td><strong>labels</strong></td>
<td><code>label variable</code> - <code>label define</code> - <code>label value</code> - <code>label list</code> - <code>label drop</code> - <strong><code>xaxis</code></strong></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>En gras, commandes externes</strong></li>
</ul>
<p>Pour accéder aux infomations sur les variables d’une base:</p>
<ul>
<li>Utiliser le <strong>variables manager</strong> ou la fenêtre d’information <strong>variables properties</strong> si elle est ancrée à l’interface. Ces deux outils permettent de faire des modifications et de récupérer la ligne de commande dans la fenêtre <em>command</em>. Le verrou de la fenêtre <strong>variables properties</strong> doit-être retiré .</li>
<li>Utiliser la commande <code>describe</code> [<code>des</code>] ou la commande <code>ds</code> pour un usage plus avancé (sélection de variables selon leur type par exemple).</li>
</ul>
<p><strong><em>Variables manager</em></strong><br>
<a href="img5/g1.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="img5/g1.PNG" class="img-fluid" style="width:50.0%"></a> <br></p>
<p><strong><em>Fenêtre properties à droite de l’interface principale (mode dévérouillé)</em></strong><br>
<a href="img5/g2.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="img5/g2.PNG" class="img-fluid" style="width:50.0%"></a></p>
<p><strong>Commande describe</strong></p>
<div class="cell" data-collectcode="true">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sysuse</span> auto, <span class="kw">clear</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">describe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>(1978 automobile data)


Contains data from C:\PROGRA~1\Stata17\ado\base/a/auto.dta
 Observations:            74                  1978 automobile data
    Variables:            12                  13 Apr 2020 17:45
                                              (_dta has notes)
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
make            str18   %-18s                 Make and model
price           int     %8.0gc                Price
mpg             int     %8.0g                 Mileage (mpg)
rep78           int     %8.0g                 Repair record 1978
headroom        float   %6.1f                 Headroom (in.)
trunk           int     %8.0g                 Trunk space (cu. ft.)
weight          int     %8.0gc                Weight (lbs.)
length          int     %8.0g                 Length (in.)
turn            int     %8.0g                 Turn circle (ft.)
displacement    int     %8.0g                 Displacement (cu. in.)
gear_ratio      float   %6.2f                 Gear ratio
foreign         byte    %8.0g      origin     Car origin
-------------------------------------------------------------------------------
Sorted by: foreign</code></pre>
</div>
</div>
<section id="types-et-format" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> <strong>Types et format</strong></h1>
<section id="types" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="types"><span class="header-section-number">1.1</span> Types</h2>
<p>Stata gère tous les types de variables: numérique, caractère, date. Un type de variable est un type de stockage.</p>
<ul>
<li>Types numériques: <em>float</em>, <em>long</em>, <em>double</em>, <em>int</em> et <em>byte</em>.</li>
<li>Types caractère: <em>str#</em> et <em>strL</em> (très grandes chaînes de caractères). # est la longueur de la chaîne de caractère, elle ne peut pas excéder 2046 pour le type <em>str</em>.</li>
</ul>
<p>Plus d’informations: <code>help data types</code></p>
<p>Modification du type de variable</p>
<ul>
<li>Optimisation du poids en mémoire avec <code>compress</code></li>
<li>Commande <strong><code>recast</code></strong></li>
</ul>
<p><strong><em>Optimisation du poids de la base</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">compress</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>  variable mpg was int now byte
  variable rep78 was int now byte
  variable trunk was int now byte
  variable turn was int now byte
  variable make was str18 now str17
  (370 bytes saved)</code></pre>
</div>
</div>
<p><strong><em>Passage de la variable make en str3</em></strong></p>
<p>En réduisant le type, on va tronquer les chaînes de caractères qui ne garderont que les 3 premières lettres, à manupiler avec prudence donc. Pour cette opération, Stata impose une confirmation avec l’option <code>force</code>.</p>
<p><strong><em>Variable d’origine</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> make </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> make <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
make            str18   %-18s                 Make and model

     +---------------+
     | make          |
     |---------------|
  1. | AMC Concord   |
  2. | AMC Pacer     |
  3. | AMC Spirit    |
  4. | Buick Century |
  5. | Buick Electra |
     |---------------|
  6. | Buick LeSabre |
  7. | Buick Opel    |
  8. | Buick Regal   |
  9. | Buick Riviera |
 10. | Buick Skylark |
     +---------------+</code></pre>
</div>
</div>
<p><strong><em>Modification du type</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">recast</span> str3 make, <span class="kw">force</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> make</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> make <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>make:  74 values changed


Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
make            str3    %-9s                  Make and model

     +------+
     | make |
     |------|
  1. | AMC  |
  2. | AMC  |
  3. | AMC  |
  4. | Bui  |
  5. | Bui  |
     |------|
  6. | Bui  |
  7. | Bui  |
  8. | Bui  |
  9. | Bui  |
 10. | Bui  |
     +------+</code></pre>
</div>
</div>
</section>
<section id="format" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="format"><span class="header-section-number">1.2</span> Format</h2>
<p>Il s’agit du format d’affichage des valeurs des variables. Ils peuvent être modifiés sans que le type soit changé (décimales, alignement….).</p>
<p>Variables numérique:<br>
- format <em>g</em>: <em>général</em> (définition un peu obsure pour moi) - format <em>f</em>: <em>fixe</em> - plusieurs format d’affichage pour les variables de type dates: <em>%td</em> (date avec jour-mois-année), <em>%tm</em> (mois), <em>%tq</em> (trimestre), <em>%tw</em> (semaine). Les dates et leur manipulation sont un domaines très riche, et feront l’objet d’une courte présentation en fin de chapite.</p>
<p>On peut changer le format d’affichage avec la commande <strong><code>format</code></strong>. Si le format est de type général (g), il est préférable de passer à un format de type fixe (f) On peut un même format à une liste de variables.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">format</span> %<span class="kw">format</span> <span class="kw">varlist</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><strong>Exemple: changement du nombre de décimales</strong></p>
<p>Dans la base <em>auto</em>, la variable <em>gear_ratio</em> est de format fixe à 2 décimales (%6.2f). Pour supprimer, à l’affichage, les deux décimales: afficher les valeurs sans décimales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> gear_ratio <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     | gear_r~o |
     |----------|
  1. |     3.58 |
  2. |     2.53 |
  3. |     3.08 |
  4. |     2.93 |
  5. |     2.41 |
     |----------|
  6. |     2.73 |
  7. |     2.87 |
  8. |     2.93 |
  9. |     2.93 |
 10. |     3.08 |
     +----------+</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">format</span> %6.0f gear_ratio</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> gear_ratio <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     | gear_r~o |
     |----------|
  1. |        4 |
  2. |        3 |
  3. |        3 |
  4. |        3 |
  5. |        2 |
     |----------|
  6. |        3 |
  7. |        3 |
  8. |        3 |
  9. |        3 |
 10. |        3 |
     +----------+</code></pre>
</div>
</div>
<p><strong>Exemple: aligner le nombre décimal reporté avec <code>summarize</code> sur le format de la variable</strong></p>
<p>Avec l’option <code>format</code> appliquée à la commande <code>summarize</code> on peut automatiquement réduire le nombre de décimales reportées dans l’output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> gear_ratio</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> gear_ratio, <span class="kw">d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
  gear_ratio |         74    3.014865    .4562871       2.19       3.89

                         Gear ratio
-------------------------------------------------------------
      Percentiles      Smallest
 1%         2.19           2.19
 5%         2.28           2.24
10%         2.43           2.26       Obs                  74
25%         2.73           2.28       Sum of wgt.          74

50%        2.955                      Mean           3.014865
                        Largest       Std. dev.      .4562871
75%         3.37           3.78
90%         3.72           3.78       Variance       .2081979
95%         3.78           3.81       Skewness       .2191658
99%         3.89           3.89       Kurtosis       2.101812</code></pre>
</div>
</div>
<p>Avec l’option <strong><code>format</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> gear_ratio, <span class="kw">format</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> gear_ratio, <span class="kw">d</span> <span class="kw">format</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
  gear_ratio |         74        3.01        0.46       2.19       3.89

                         Gear ratio
-------------------------------------------------------------
      Percentiles      Smallest
 1%         2.19           2.19
 5%         2.28           2.24
10%         2.43           2.26       Obs                  74
25%         2.73           2.28       Sum of wgt.          74

50%         2.96                      Mean               3.01
                        Largest       Std. dev.          0.46
75%         3.37           3.78
90%         3.72           3.78       Variance           0.21
95%         3.78           3.81       Skewness           0.22
99%         3.89           3.89       Kurtosis           2.10</code></pre>
</div>
</div>
</section>
<section id="modification-du-type" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="modification-du-type"><span class="header-section-number">1.3</span> Modification du type</h2>
<p>Il est possible de basculer d’un type caractère à un type numérique et inversement</p>
<p><strong>De numérique à caractère</strong></p>
<p><br> Si la variable numérique n’a pas de label affecté sur les modalités, ou qu’on ne veut pas conserver l’information données par les labels, on peut utiliser la commande <code>tostring</code>. On peut créer une nouvelle variable avec l’option <code>gen()</code> ou remplacer la variable numérique d’origine avec l’option <code>replace</code>. Une des deux options doit être nécessairement renseignée.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">tostring</span> [<span class="kw">varlist</span>], <span class="kw">gen</span>(nom_varlist)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">tostring</span> [<span class="kw">varlist</span>], <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple avec la variable <em>foreign</em> qui prend les valeur 0 et 1 avec les labels “domestic” (0) et “foreign” (1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tostring</span> foreign, <span class="kw">gen</span>(foreign_str)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> foreign foreign_str</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> foreign foreign_str</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>foreign_str generated as str1


Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
foreign         byte    %8.0g      origin     Car origin
foreign_str     str1    %9s                   Car origin

           |      Car origin
Car origin |         0          1 |     Total
-----------+----------------------+----------
  Domestic |        52          0 |        52 
   Foreign |         0         22 |        22 
-----------+----------------------+----------
     Total |        52         22 |        74 </code></pre>
</div>
</div>
<p>Si la variable numérique a des labels affectés aux modalités modalités et qu’on souhaite conserver cet information, on utilise la commande <strong><code>decode</code></strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">decode</span> <span class="kw">variable</span>, <span class="kw">gen</span>(nom_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple avec la variable <em>foreign</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">decode</span> foreign, <span class="kw">gen</span>(foreign_str)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> foreign foreign_str</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> foreign_str</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
foreign         byte    %8.0g      origin     Car origin
foreign_str     str8    %9s                   Car origin


 Car origin |      Freq.     Percent        Cum.
------------+-----------------------------------
   Domestic |         52       70.27       70.27
    Foreign |         22       29.73      100.00
------------+-----------------------------------
      Total |         74      100.00</code></pre>
</div>
</div>
<p><strong>De caractère à numérique</strong></p>
<p>Si la variable caractère est a une forme numerique (une suite de nombre comme des années, des âges…), on utilise la commande <code>destring</code>. Lorsqu’il y a des des valeurs manquantes à la variable, on doit uiliser l’option <code>force</code>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Stata</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">destring</span> [<span class="kw">varlist</span>] , <span class="kw">gen</span>(nom_varlist) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">destring</span> [<span class="kw">varlist</span>] , <span class="kw">replace</span> [<span class="kw">force</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple avec la variable <em>rep78</em> qui est transformé dans un premier temps en variables caractère avec <code>tostring</code> puis de nouveau transformé en format numérique avec <code>destring</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tostring</span> rep78, <span class="kw">replace</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> rep78</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">destring</span> rep78, <span class="kw">replace</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> rep78</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>rep78 was int now str1


Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
rep78           str1    %9s                   Repair record 1978

rep78: all characters numeric; replaced as byte
(5 missing values generated)


Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
rep78           byte    %10.0g                Repair record 1978</code></pre>
</div>
</div>
<p>Si la variable caractère n’est pas de forme numérique et que l’on souhaite récupérer les labels sur les modalités, on peut utiliser la commande <strong><code>encode</code></strong> ou la commande externe <strong><code>sencode</code></strong> (<code>net install st0043_2, force</code>). La seconde permet de remplacer directement la variable d’origine, option particulièrement pratique.. Egalement, cette commande permet plus de souplesse sur le codage de la variable (<code>help sencode</code> pour plus de détail).</p>
<p>Avec <code>encode</code> ou <code>sencode</code> sans l’option <code>gsort</code>, le numéro de la modalité suivra l’ordre alphabétique des chaînes de caractère de la variable: si la variable caractère à pour valeur (“Homme”, “Femme”), “femme” sera automatiquement codée 1 et “homme” 2.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> <span class="kw">variable</span>, <span class="kw">gen</span>(nom_variable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>```{} </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>sencode <span class="kw">variable</span>, <span class="kw">gen</span>(nom_variable) <span class="kw">replace</span> <span class="kw">gsort</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple avec la variable <em>foreign_str</em> (variable caractère créée précédemment à partir de la variable foreign)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> foreign_str, <span class="kw">gen</span>(foreign2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> foreign2</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> foreign2, nolab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>variable foreign_str not found
r(111);

end of do-file
r(111);</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Type de variable pour les modèles
</div>
</div>
<div class="callout-body-container callout-body">
<p>Les variables de type caractères ne sont pas acceptées, Stata renvoie alors un message d’erreur avec <strong>no observation</strong>. Si c’est le cas, les commandes <code>destring</code> et <code>encode</code> vont s’avérer particulièrement utiles.</p>
</div>
</div>
</section>
</section>
<section id="création-dune-variable" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> <strong>Création d’une variable</strong></h1>
<section id="generate---replace" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="generate---replace"><span class="header-section-number">2.1</span> generate - replace</h2>
<p>La création d’une nouvelle variable se fait avec la commande <code>generate</code> généralement tronquée jusqu’à <code>gen</code>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> nom_variable=valeur/fonction [expression: <span class="kw">if</span> <span class="kw">in</span> <span class="fu">inlist</span> <span class="fu">inrange</span>...]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Pour remplacer la valeur d’une valeur variable existante on utilise la commande <code>replace</code>. Le nom n’est malheureusement pas tronquable.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> nom_variable=valeur/fonction [expression: <span class="kw">if</span> <span class="kw">in</span> <span class="fu">inlist</span> <span class="fu">inrange</span>...]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li>On peut utiliser le préfixe <code>bysort</code></li>
<li>Pour utiliser une fonction mathématique (log, exp, .) =&gt; <code>help math_functions</code></li>
<li>Pour afficher la liste complète des fonctions (variables caractères, statistiques, pseudo nombre aléatoire, dates.): <code>help function</code></li>
</ul>
<p><strong>Rappel</strong>: attention entre l’opérateur d’affectation (<code>=</code>) et l’expression conditionnelle (<code>==</code>).</p>
<p><br></p>
<p><strong>Création d’une indicatrice (0,1)</strong><br>
<br> On peut rapidement générer des indicatrices (0,1) à partir d’une expression conditionnelle:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> x= expression_conditionnelle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple avec la variable <em>rep78</em>. On génère la variable <em>rep2</em> qui prend la valeur 1 si <em>rep78</em>&gt;3, 0 sinon. Comme il y a des valeurs manquantes dans la variable d’origine, on corrige l’information pour l’indicatrice dont les valeurs manquantes ont été automatiquement affectées à la valeur 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> rep2 = rep78&gt;3</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> rep2 = . <span class="kw">if</span> rep78==.</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> rep78 rep2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>(5 real changes made, 5 to missing)

    Repair |
    record |         rep2
      1978 |         0          1 |     Total
-----------+----------------------+----------
         1 |         2          0 |         2 
         2 |         8          0 |         8 
         3 |        30          0 |        30 
         4 |         0         18 |        18 
         5 |         0         11 |        11 
-----------+----------------------+----------
     Total |        40         29 |        69 </code></pre>
</div>
</div>
<p><br> Remarque: Avec la commande <code>tabulate</code> on peut créer une série d’indicatrices à partir d’une variable catégorielle avec l’option <code>gen(nom_variable)</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> x, <span class="kw">gen</span>(nom_variable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple avec la variable <em>foreign</em>. Avec <code>tabulate</code> on va générer deux indicatrices: <em>origine1</em> si <em>foreign</em>=0, et <em>origine2</em> si <em>foreign</em>=1. Un label à la variable est automatiquement créé indiquant la valeur de la variable d’origine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> foreign, <span class="kw">gen</span>(origine)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> origine1 origine2</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> origine1 foreign</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> origine2 foreign</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code> Car origin |      Freq.     Percent        Cum.
------------+-----------------------------------
   Domestic |         52       70.27       70.27
    Foreign |         22       29.73      100.00
------------+-----------------------------------
      Total |         74      100.00


Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
origine1        byte    %8.0g                 foreign==Domestic
origine2        byte    %8.0g                 foreign==Foreign


foreign==D |      Car origin
   omestic |  Domestic    Foreign |     Total
-----------+----------------------+----------
         0 |         0         22 |        22 
         1 |        52          0 |        52 
-----------+----------------------+----------
     Total |        52         22 |        74 


foreign==F |      Car origin
    oreign |  Domestic    Foreign |     Total
-----------+----------------------+----------
         0 |        52          0 |        52 
         1 |         0         22 |        22 
-----------+----------------------+----------
     Total |        52         22 |        74 </code></pre>
</div>
</div>
</section>
<section id="egen" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="egen"><span class="header-section-number">2.2</span> egen</h2>
<p><strong><code>egen</code></strong>: extented generate<br>
<strong><code>egenmore</code></strong>: package programmé par NJ.Cox qui ajoute des fonctions associée à <code>egen</code> [<code>ssc install egenmore</code>]</p>
<p>Réservé à l’utilisation de fonctions. Pour obtenir la liste <code>help egen</code>.<br>
<br></p>
<p><strong><em>Exemple</em></strong>: on va créer dans un premier la variable <em>mprice</em> qui reporte pour chaque observation la moyenne de la variable <em>price</em>. Dans un second temps, on va créer la variable <em>mprice_or</em>, mais avec le prix moyen des voitures selon leur origine (<em>foreign</em>). La fonction utilisée est la fonction <strong><code>mean()</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> mprice = <span class="kw">mean</span>(price)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span>  make price mprice <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     | make             price     mprice |
     |-----------------------------------|
  1. | AMC Concord      4,099   6165.257 |
  2. | AMC Pacer        4,749   6165.257 |
  3. | AMC Spirit       3,799   6165.257 |
  4. | Buick Century    4,816   6165.257 |
  5. | Buick Electra    7,827   6165.257 |
     |-----------------------------------|
  6. | Buick LeSabre    5,788   6165.257 |
  7. | Buick Opel       4,453   6165.257 |
  8. | Buick Regal      5,189   6165.257 |
  9. | Buick Riviera   10,372   6165.257 |
 10. | Buick Skylark    4,082   6165.257 |
     +-----------------------------------+</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> foreign: <span class="kw">egen</span> mprice_or = <span class="kw">mean</span>(price)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span>  make price mprice <span class="kw">in</span> 1/5</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span>  make price mprice <span class="kw">in</span> 66/70</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     | make            price   mprice~r |
     |----------------------------------|
  1. | AMC Concord     4,099   6072.423 |
  2. | AMC Pacer       4,749   6072.423 |
  3. | AMC Spirit      3,799   6072.423 |
  4. | Buick Century   4,816   6072.423 |
  5. | Buick Electra   7,827   6072.423 |
     +----------------------------------+

     +-----------------------------------+
     | make             price   mprice~r |
     |-----------------------------------|
 66. | Subaru           3,798   6384.682 |
 67. | Toyota Celica    5,899   6384.682 |
 68. | Toyota Corolla   3,748   6384.682 |
 69. | Toyota Corona    5,719   6384.682 |
 70. | VW Dasher        7,140   6384.682 |
     +-----------------------------------+</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Les fonctions <code>sum()</code> et <code>total()</code>**
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sans aucune explication, la fonction <code>sum()</code> qui permet d’obtenir une somme incrémentale n’est pas associée à <code>egen</code> mais à <code>generate</code>. En revanche la fonction <code>total()</code> est associée à <code>egen</code>. Il faut le retenir.</p>
<p><strong>Exemple</strong>: on veut créer un identifiant numérique (variable <em>id</em>) pour chaque voiture (dans la base on a une seule voiture par nom de voiture).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> x = 1 </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> id = <span class="kw">sum</span>(x)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> id make <span class="kw">in</span> 1/5</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> id make <span class="kw">in</span> 66/70</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     | id   make          |
     |--------------------|
  1. |  1   AMC Concord   |
  2. |  2   AMC Pacer     |
  3. |  3   AMC Spirit    |
  4. |  4   Buick Century |
  5. |  5   Buick Electra |
     +--------------------+

     +---------------------+
     | id   make           |
     |---------------------|
 66. | 66   Subaru         |
 67. | 67   Toyota Celica  |
 68. | 68   Toyota Corolla |
 69. | 69   Toyota Corona  |
 70. | 70   VW Dasher      |
     +---------------------+</code></pre>
</div>
</div>
<p>Si on veut reporter le nombre total d’observations dans la base (variable <em>N</em>), avec la fonction <code>total</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">egen</span> <span class="kw">N</span> = <span class="kw">total</span>(x)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> id <span class="kw">N</span> make <span class="kw">in</span> 1/5</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> id <span class="kw">N</span> make <span class="kw">in</span> 66/70</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>x not found
r(111);

end of do-file
r(111);</code></pre>
</div>
</div>
</div>
</div>
<p>On va le voir, ces deux variables qui ont été générées peuvent l’être directement avec les <em>variables internes dites de comptage</em>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Package gegen (M.Caceres)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Pour les volumétries dépassant le million d’observation il est fortement conseillé d’utilisée les commandes associées au package de <em>Mauricio Caceres</em>, ici la commande <strong><code>gege,</code></strong>.</li>
<li><a href="https://gtools.readthedocs.io/en/latest/" class="uri">https://gtools.readthedocs.io/en/latest/</a></li>
<li><a href="https://mthevenin.github.io/stata_programmation/speedup/gtools.html" class="uri">https://mthevenin.github.io/stata_programmation/speedup/gtools.html</a></li>
</ul>
</div>
</div>
</section>
</section>
<section id="les-variables-internes-de-comptage" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> <strong>Les variables internes de comptage</strong></h1>
<p>Très utile avec des données longitudinales, de durées ou toute base avec des données avec cluster. <br></p>
<p>Deux variables de comptage: <code>_n</code> et <code>_N</code><br>
<br></p>
<ul>
<li><strong><code>_n</code></strong> : renvoie le rang de l’observation<br>
</li>
<li><strong><code>_N</code></strong>: renvoie le nombre total d’observations</li>
</ul>
<p><strong>Application</strong>: On veut créer un identifiant sur l’ensemble des observations de la base auto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> id = <span class="dt">_n</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> make foreign id <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>     | make             foreign   id |
     |-------------------------------|
  1. | AMC Concord     Domestic    1 |
  2. | AMC Pacer       Domestic    2 |
  3. | AMC Spirit      Domestic    3 |
  4. | Buick Century   Domestic    4 |
  5. | Buick Electra   Domestic    5 |
     |-------------------------------|
  6. | Buick LeSabre   Domestic    6 |
  7. | Buick Opel      Domestic    7 |
  8. | Buick Regal     Domestic    8 |
  9. | Buick Riviera   Domestic    9 |
 10. | Buick Skylark   Domestic   10 |
     +-------------------------------+</code></pre>
</div>
</div>
<p><strong>lead &amp; lag</strong></p>
<p>Par défaut, pour toutes les instructions le rang sélectionné est celui de la ligne de l’observation x=x[_n]</p>
<ul>
<li>Lag(-1): Sélection du rang inférieur d’une variable x: <strong><span class="math inline">\(x=x[_n-1]\)</span></strong>. Remarque: la première observation est une valeur manquante.</li>
<li>lead(+1): Sélection du rang supérieur d’une variable x: <strong><span class="math inline">\(x=x[_n-1]\)</span></strong>. Remarque: la dernière observation est une valeur manquante.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> lag_make  = make[<span class="dt">_n</span>-1]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> lead_make = make[<span class="dt">_n</span>+1]</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> make lag_make lead_make <span class="kw">in</span> 1/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>(1 missing value generated)

(1 missing value generated)

     +-----------------------------------------------+
     | make                 lag_make       lead_make |
     |-----------------------------------------------|
  1. | AMC Concord                         AMC Pacer |
  2. | AMC Pacer         AMC Concord      AMC Spirit |
  3. | AMC Spirit          AMC Pacer   Buick Century |
  4. | Buick Century      AMC Spirit   Buick Electra |
  5. | Buick Electra   Buick Century   Buick LeSabre |
     |-----------------------------------------------|
  6. | Buick LeSabre   Buick Electra      Buick Opel |
  7. | Buick Opel      Buick LeSabre     Buick Regal |
  8. | Buick Regal        Buick Opel   Buick Riviera |
  9. | Buick Riviera     Buick Regal   Buick Skylark |
 10. | Buick Skylark   Buick Riviera    Cad. Deville |
     +-----------------------------------------------+</code></pre>
</div>
</div>
</section>
<section id="sélection-de-plusieurs-modalités-recodage" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> <strong>Sélection de plusieurs modalités, recodage</strong></h1>
<p><strong>inlist</strong><br>
Pour sélectionner plusieurs modalités d’une variable dans une expression conditionnelle <code>inlist(variable, valeur1, valeur2,..)</code>.<br>
Utile si la variable n’est pas de type ordinale.<br>
Exemple: <code>gen Y=1 if inlist(X,1,3,6,10)</code><br>
L’expression est hélas toujours limitée à 10 valeurs pour les variables caractères.<br>
<br></p>
<p><strong>inrange</strong><br>
Pour sélectionner un intervalle dans une expression <code>inrange(variable, valeur1,valeur2)</code> avec <span class="math inline">\(valeur1&lt;valeur2\)</span>.<br>
Exemple: <code>gen Y= inrange(X,5,10)</code> pour obtenir <span class="math inline">\(Y=1\)</span> si <span class="math inline">\(50\leq x\leq 10\)</span> 0 sinon.<br>
<br> <strong>recode</strong><br>
Permet de changer les valeurs d’une variable numérique:</p>
<p>`recode variable (anciennes_valeurs=nouvelle_valeur) (ancienne_valeurs=nouvelles_valeur)…..```</p>
<p><br> <strong>Application</strong>: recoder la variable foreign 0=&gt;1 et 1=&gt;2.</p>
</section>
<section id="les-labels" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> <strong>Les labels</strong></h1>
<p>La création et la modification peut se faire directement via la boite de dialogue du <strong>variable manager</strong>.</p>
<p><br> <strong>Label des variables</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> nom_variable <span class="st">"label"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>On peut modifier/écraser un label existant</p>
<p>Exemple</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> foreign</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">variable</span> foreign <span class="st">"Origine de la voiture"</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> foreign</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
foreign         byte    %8.0g      origin     Car origin



Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
foreign         byte    %8.0g      origin     Origine de la voiture</code></pre>
</div>
</div>
<p><strong>Label sur les modalités des variables</strong><br>
<br> Deux étapes: la création des label et leurs affectation à une ou plusieurs variables. <br> <strong>Création du label</strong>: <strong><code>label define</code></strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> nom_label val1 <span class="st">"label1"</span> val2 <span class="st">"label2"</span>... [,modify]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Exemple variable binaire (0,1) labélisée “No-Yes” avec comme nom de label NY : <code>label define NY 0 "non" 1 "oui"</code></p>
<p>S’il y a beaucoup de modalités à labelliser, on peut affecter ligne par ligne un label par modalité et utiliser l’option <code>modify</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> nom_label 1 <span class="st">"nom1"</span>, modify</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> nom_label 2 <span class="st">"nom2"</span>, modify</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> nom_label 3 <span class="st">"nom3"</span>, modify</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> nom_label 4 <span class="st">"nom2"</span>, modify</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><strong>Affectation du label</strong>: <strong><code>label value</code></strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Syntaxe</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="ot">value</span> nom_variable nom_label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><strong><em>Exercice</em></strong>: créer une variable indicatrice qui regroupe de la varble rep78: 0 si rep78&lt;4 et 1 si rep78&gt;3. Affecter un label à la variable (au choix) et des labels aux modalités (au choix).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> rep78b = rep78&lt;4</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> rep78b=. <span class="kw">if</span> rep78==.</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> rep78b 0 <span class="st">"1-3 réparations"</span> 1 <span class="st">"Plus de 3 réparations"</span>, modify</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="ot">value</span> rep78b rep78b</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="kw">des</span> rep78b</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> rep78 rep78b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre class="result"><code>(5 real changes made, 5 to missing)




Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
rep78b          float   %22.0g     rep78b     

    Repair |
    record |        rep78b
      1978 | 1-3 répar  Plus de 3 |     Total
-----------+----------------------+----------
         1 |         0          2 |         2 
         2 |         0          8 |         8 
         3 |         0         30 |        30 
         4 |        18          0 |        18 
         5 |        11          0 |        11 
-----------+----------------------+----------
     Total |        29         40 |        69 </code></pre>
</div>
</div>
<p><strong>Fichiers de labels et multilangue</strong></p>
<p><strong>label save</strong><br>
On peut générer un fichier (.do) donnant le programme qui génère les labels (existants) d’une base: commande <code>label save</code> (par le menu: data =&gt; data utilities =&gt; label utilities =&gt; save labels as do file).<br>
<br> <strong>multilangue</strong><br>
Pour des enquêtes internationales, on peut de créer des labels en plusieurs langues switcher d’une langue à l’autre (exemple MAFE l’Ined). La commande doit être installée, elle est externe à Stata (<code>ssc install mlanguage</code> - auteur <em>Jeroen Weesie</em>).</p>
<section id="todo" class="level2 callout_note" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="todo"><span class="header-section-number">5.1</span> TODO</h2>
<p>Faire un rapide topo sur les variables de type dates</p>
</section>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../formation/chapitre4.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Les bases de données</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../formation/chapitre6.html" class="pagination-link">
        <span class="nav-page-text">Opérations sur les bases</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Marc Thévenin - Ined-Sms - Mars 2022</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"loop":true,"selector":".lightbox","descPosition":"bottom","openEffect":"zoom","closeEffect":"zoom"});</script>



</body></html>